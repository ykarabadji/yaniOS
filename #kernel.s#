; kernel.s - The kernel's entry point in 32-bit protected mode
[bits 32]

; Export the _start label so the linker can find it
[global _start]

; Inform the linker that the 'main' function is defined elsewhere (in main.c)
[extern main]

_start:
   
    
    mov ax, 0x10          ;
    mov ds, ax
    mov es, ax
    mov fs, ax
    mov gs, ax
    mov ss, ax            
      mov     byte [ds:0xB8005], 0x07
      mov     byte [ds:0xB8004], 'P'
    
    mov esp, 0x90000  
    cli
  
  
  
   
    ; keyboard_entry.asm
global keyboard_entry
extern keyboard_handler

keyboard_entry:
    pusha
    call keyboard_handler
    popa
    iretd

    call main
    jmp $

   
.halt:
    hlt                   ; Halt the CPU
    jmp .halt             ; Loop forever just in case the hlt instruction is ignored


